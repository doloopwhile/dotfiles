#!/usr/bin/env python
import argparse
import errno
import itertools
import os
import sys

p = argparse.ArgumentParser(description="filtering lines by 'slice'")
p.add_argument('--start', type=int)
p.add_argument('--stop',  type=int)
p.add_argument('--step',  type=int)
args = p.parse_args()

if (args.start is None and
    args.stop is None and
    args.step is None):
    p.error("Specify either --start, --stop or --step")

try:
    for line in itertools.islice(sys.stdin, args.start, args.stop, args.step):
        sys.stdout.write(line)
except IOError as e:
    if e.errno == errno.EPIPE:
        # Pipe closed. It is expected.
        sys.exit(0)
    else:
        sys.stderr.write("slice: {}\n".format(e))
        sys.exit(1)
