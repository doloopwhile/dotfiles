#!/bin/bash
REDMINE_URL="https://redmine.m3.com/"

if [ "$#" -eq 0 ]; then
  BRANCH="$(git branch 2>/dev/null | grep '^\*' | sed -e "s/^* //")"
  if [[ "$BRANCH" =~ ^feature/([0-9]+)(-.*)?$ ]]; then
    open "${REDMINE_URL}/issues/${BASH_REMATCH[1]}"
  else
    echo 'Branch name does not match [feature/123456-some-description]' >&2
    open "${REDMINE_URL}"
    exit 1
  fi
else
  open "${REDMINE_URL}/${1}"
fi

